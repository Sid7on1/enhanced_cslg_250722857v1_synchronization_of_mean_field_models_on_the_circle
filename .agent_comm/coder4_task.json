{
  "agent_id": "coder4",
  "task_id": "task_4",
  "files": [
    {
      "name": "utils.py",
      "purpose": "Utility functions and helpers",
      "priority": "low"
    },
    {
      "name": "setup.py",
      "purpose": "Package installation setup",
      "priority": "low"
    }
  ],
  "project_info": {
    "project_name": "enhanced_cs.LG_2507.22857v1_Synchronization_of_mean_field_models_on_the_circle",
    "project_type": "transformer",
    "description": "Enhanced AI project based on cs.LG_2507.22857v1_Synchronization-of-mean-field-models-on-the-circle with content analysis. Detected project type: transformer (confidence score: 5 matches).",
    "key_algorithms": [
      "Stylized",
      "Kuramoto",
      "Self-Attention",
      "Mean-Field",
      "Simplified",
      "Simple",
      "Same",
      "Token",
      "Original"
    ],
    "main_libraries": [
      "torch",
      "numpy",
      "pandas"
    ]
  },
  "paper_content": "PDF: cs.LG_2507.22857v1_Synchronization-of-mean-field-models-on-the-circle.pdf\nChunk: 1/1\n==================================================\n\n--- Page 1 ---\nSynchronization of mean-field models on the circle\nY. Polyanskiy\u2217, P. Rigollet\u2020, A. Yao\u2021\nJanuary 2025\nAbstract\nThis paper considers a mean-field model of ninteracting particles whose state\nspace is the unit circle, a generalization of the classical Kuramoto model. Global\nsynchronization is said to occur if after starting from almost any initial state, all\nparticles coalesce to a common point on the circle. We propose a general syn-\nchronization criterion in terms of L1-norm of the third derivative of the particle\ninteraction function. As an application we resolve a conjecture for the so-called\nself-attention dynamics (stylized model of transformers), by showing synchroniza-\ntion for all \u03b2\u2265 \u22120.16, which significantly extends the previous bound of 0 \u2264\u03b2\u22641\nfrom Criscitiello, Rebjock, McRae, and Boumal [11]. We also show that global\nsynchronization does not occur when \u03b2 <\u22122/3.\n1 Introduction\nIn this paper, we consider a simple dynamical system consisting of ninteracting particles\nx1, . . . , x nsituated on the unit sphere S1, which we identify with the standard 1-torus\nS1\u2243T\u225cR/2\u03c0Z. The dynamics are given by\n\u02d9xi(t) =\u2212nX\nj=1f(xi(t)\u2212xj(t)),\u2200i\u2208[n]. (S1)\nInterest in such systems originated with the work of Kuramoto [24], who analyzed the\nspecial case where f(x) = sin( x).1Kuramoto discovered a fascinating synchronization\nphenomenon in this system, which we define below.\nDefinition 1.1. In (S1), synchronization occurs for a starting point ( xi(0)) 1\u2264i\u2264nif there\nexists x\u2217\u2208[0,2\u03c0) such that lim t\u2192\u221exi(t)\u2261x\u2217for all i\u2208[n]. We say that a pair ( A, f)\nexhibits global synchronization if synchronization occurs for almost every starting point\n(with respect to the volume measure).\n\u2217Department of EECS, MIT. Email: yp@mit.edu\n\u2020Department of Mathematics, MIT. Email: rigollet@math.mit.edu\n\u2021Departments of EECS and Mathematics, MIT. Email: ajyao@mit.edu\n1We consider only the so-called homogeneous Kuramoto model, without particle-dependent drift terms.\n1arXiv:2507.22857v1  [math.DS]  30 Jul 2025\n\n--- Page 2 ---\nMathematical models of synchronization, such as Kuramoto\u2019s, are simplified abstrac-\ntions of the ubiquitous self-organization phenomena observed in nature [36]. While many\nother models have been proposed in physics [35], biology [27], and engineering [4, 19],\nKuramoto\u2019s model remains the simplest to exhibit this effect.\nThe seminal paper of Kuramoto [24] has ushered a rich line of work sharpening, gen-\neralizing, and applying his original framework; see [32, 3]. After successive advances,\nglobal synchronization for the mean-field Kuramoto model was eventually established in\n[33], which also expanded the original Kuramoto model beyond the mean-field case by\nallowing each particle to interact with only a subset of the others; see [1, 20] for the most\nrecent advances on this front.\nThe dynamical system (S1) is an example of a mean-field model, since its motion can\nbe rewritten as:\n\u02d9xi(t) =X[\u00b5n(t)](xi), \u00b5 n(t)\u225c1\nnnX\nj=1\u03b4xj(t),X[\u00b5](x)\u225c\u2212Z\nTf(x\u2212y)\u00b5(dy),\nwhere \u00b5n(t) denotes the empirical measure (distribution) of the particles and X[\u00b5] is the\nmeasure-dependent vector field driving each particle. Since particles are indistinguishable\nin mean-field models, it suffices to study the evolution of the empirical measure \u00b5n(t),\nwhich satisfies the continuity equation:\n\u02d9\u00b5(t) + div( \u00b5X[\u00b5]) = 0 . (1)\nWhen \u00b5(0) = \u00b5n(0) =1\nnPn\nj=1\u03b4xj(0), studying (1) is equivalent to studying (S1), but one\ncan also study solutions of (1) starting from non-discrete measures \u00b5(0).\nFor the Kuramoto mean-field model, i.e. f(x) = sin( x), [14] showed explicit (exponen-\ntial) estimates of speed of convergence to synchronization for the dynamical system (S1)\nand, subsequently, [28] extend the exponential convergence to the more general case of\nevolution of measures solving continuity equation (1). Both works in fact consider a more\ngeneral case of the Kuramoto mean-field model with state space Sdwith d\u22651.\nA recent resurgence of interest in mean-field models on the sphere and torus arose\nfrom a discovery of [17] that with f(x) =f\u03b2(x)\u225csin(x)e\u03b2cos(x), \u03b2\u2208Rthe resulting\ninteracting particle system is intimately related to evolution of internal representations\nin transformers [34], which are modern neural networks forming the backbone of large\nlanguage models (LLMs). When f=f\u03b2, we call (S1) self-attention dynamics , on which\nthere is a fast growing body of work [29, 15, 21, 16, 11, 16, 6, 2, 7, 8, 9]. Despite\nthe complexity of practical transformers, the simple model of self-attention dynamics is\nremarkably effective at predicting how signals propagate through internal layers. From the\npractical point of view, global synchronization is an abstraction of a complex phenomenon\nin LLMs known as clustering or oversmoothing, e.g. [13, 30, 12, 23].\nThe work [17] establishes global synchronization whenever \u03b2=O(1/n) or\u03b2= \u2126( n2)\n(in both cases \u03b2\u22650 is also required) and for all state spaces Sd,d\u22651. Shortly af-\nterwards, [11] made an important observation that an earlier work of [26] in fact shows\nglobal synchronization for all \u03b2\u22650 and d\u22652. For d= 1, the authors of [11] improved\nthe argument of [17] and showed synchronization for \u03b2\u22641. In [21], the results on global\n2\n\n--- Page 3 ---\nsynchronization are further generalized but under the additional assumption that the\nsummation defining \u02d9 xiin (S1) only extends to j < i , which corresponds to a simple model\nof the ubiquitous \u201cdecoder-only\u201d LLMs implementing next-token prediction.\nMeta-stability. The novel aspect of self-attention dynamics compared to Kuramoto\u2019s\nmodel is the emergence of meta-stability above a certain critical value of \u03b2 >0. Specifi-\ncally, [17] observed empirically that once \u03b2is sufficiently large, then particles initialized\ni.i.d. uniformly evolve in two phases: first, they quickly group into \u224d\u221a\u03b2tight clusters\nand then over a much slower time-horizon the clusters progressively merge until only\none remains, thus attaining global synchronization. In [16] it is confirmed that local-\nized groups of particles contract exponentially quickly to their common center. Bruno,\nPasqualotto, and Agazzi in [6] showed that after initializing the particles xi(0) i.i.d. from\nthe uniform measure on the circle, at time t\u224dlognthe empirical measure \u00b5n(t) de-\nvelops periodic lumps with high probability. More explicitly, they show that for any\n0< \u03b4\u226a1, there exists a2\u03c0\nk-periodic probability distribution \u03bdper(t), with k\u224d\u221a\u03b2, which\nis\u03b4-away from uniform (as measured, for example, by the Wasserstein distance W1) and\nW1(\u00b5n(t), \u03bdper(t))\u21920 in probability as n\u2192 \u221e fort=t(n, \u03b4, \u03b2 )\u224dlogn.\nIn the present work, we show that with probability 1, for any fixed nand\u03b2\u22650, we\nmust have that \u00b5n(t)\u2192\u03b4x\u221east\u2192 \u221e . In turn, this implies that although the2\u03c0\nk-periodic\nphase is rather long-lived, it will eventually collapse, which implies that it is meta-stable.\nContributions. In addition to (S1), in the context of Transformers a so-called \u201cnor-\nmalized\u201d version of this dynamics is also important. This generalization of (S1) can be\nstated in the following form:\n\u02d9xi(t) =\u22121\ngi(x1(t), . . . , x n(t))nX\nj=1f(xi(t)\u2212xj(t)),1\u2264i\u2264n, (S2)\nwhere g:Tn\u2192Rn\n>0is some smooth function. In this work, we propose a general criterion\nfor systems (S1) and (S2) with state-space S1=Tto be globally synchronizing. As an\napplication, we prove (a) global synchronization for transformers (i.e. f=f\u03b2) for all\n\u03b2\u22650, thus completing the study of this class of interaction functions; (b) initiate the\nstudy of \u03b2 <0 and show global synchronization for \u03b2\u2265 \u22120.16 and non-synchronization\nfor\u03b2 <\u22122/3. Finally, in Section 6 we extend the criterion to a certain class of non-mean-\nfield systems.\nOrganization. Section 2 states all of our results formally. Section 3 contains proof\nof the main criterion for stability of system (S1), i.e. Theorem 2.1. Section 4 extends\nthe results to the normalized system (S2). Section 5 verifies that the general criterion in\nTheorem 2.1 applies to Transformer dynamics on the circle ( f=f\u03b2for all \u03b2 >\u22120.16).\nFinally, in Section 6 we further generalize the results to the dynamics where particles are\naggregated with unequal weights.\nAcknowledgments. PR is supported by NSF grants DMS-2022448 and\nCCF-2106377.\n3\n\n--- Page 4 ---\n2 Main results\nGiven a smooth vector field F:M \u2192 TMon a manifold M, a dynamical system solves\nthe ordinary differential equation (ODE):\n\u02d9x=F(x).\nPoint xis called stationary if F(x) = 0, since started from this point the system does not\nmove: \u02d9x= 0. If the trajectory of a dynamical system converges, then the limiting point\nshould necessarily be a stationary point. We call a stationary point xlocally unstable if\nthe Jacobian of Fatxhas an eigenvalue with positive real part. Note that this implies\nthat for a small neighborhood Uaround x, almost all initializations x0\u2208Uresult in\ntrajectories that escape from U.\nThe dynamical system (S1) that we consider here corresponds to taking M=Tnand\nthe vector field with i-th component being\nF(x)i=X[\u00b5n](xi) =\u2212Z\nf(xi\u2212y)d\u00b5n(y).\nAs we discussed, mean-field models can also be thought of as nexchangeable particles\n(each with state space of T) each driven by a time-dependent vector field X[\u00b5n(t)] :T\u2192\nTT, which is a function of the empirical measure \u00b5n, cf. (1).\nTheorem 2.1. Consider the mean-field model (S1) onT. Let \u03c4\u2208(0, \u03c0]satisfy f\u2032(x)<0\nfor all x\u0338\u2208[\u2212\u03c4, \u03c4]. If\n\u03c4Z\u03c0\n\u2212\u03c0|f\u2032\u2032\u2032(x)|+dx\u22644\u0010\n1 +\u03c4\n2\u03c0\u0011\nf\u2032(0),\nthen every stationary point (x1, . . . , x n)of the system (S1) onTnis either locally unstable\nor synchronized (i.e. x1=\u00b7\u00b7\u00b7=xn).\nThis characterization constitutes the main result of our work. However, to establish\nglobal synchronization in systems (S1) and (S2), we require two additional (though now\nstandard) ingredients:  Lojasiewicz\u2019s theorem and the center-stable manifold theorem.\n2.1 Gradient ascent dynamics\nThe first obstacle to synchronization could be the emergence of limit cycles. It turns\nout, however, that Transformer dynamics is special since it can be written as a gradient\nascent for a certain energy function E(x), see [17, (3.5)] and (3) below. Consequently, as\nexplained in [17, Appendix A] (also [18, Corollary 5.1]), classical  Lojasiewicz\u2019s theorem [25]\nguarantees that as long as Eis real analytic, the gradient ascent dynamics \u02d9x=\u2207ME(x)\nover a compact Riemannian manifold must converge to some stationary point x\u221e. (We\ndenote \u2207Mthe Riemannian gradient on a manifold, see [5] for details.)\nThe next issue is that even for f=f\u03b2, the system (S1) has many stationary points\nother than the synchronized ones (for example, when the particles are placed at the\nvertices of a regular n-gon). While Theorem 2.1 ascertains those must be locally unstable,\n4\n\n--- Page 5 ---\nwe still need to rule out existence of those serendipitous initial conditions that would lead\nto those limiting configurations. This is the content of another classical ingredient: the\ncenter-stable manifold theorem, which indeed shows that the limiting stationary point is\nalmost always a stable one [31, Theorem III.7 and Exercise III.3].\nPutting these two ideas together, we get the following result that together with Theo-\nrem 2.1 ascertain convergence to the synchronized states in f\u03b2dynamics with or without\nnormalization.\nLemma 2.2 ([17, Lemma A.1]) .LetMbe a compact Riemannian manifold and let\nE:M \u2192 Rbe a smooth function. The set of initial conditions X0\u2208 M for which the\ngradient ascent system(\n\u02d9x(t) =\u2207ME(x(t)),\nx(0) = X0\nconverges to a critical point of Eat which the Hessian of Ehas a positive eigenvalue is of\nvolume zero.\nWith these preparations, we are ready to derive our main global synchronization results\nby applying Lemma 2.2 and Theorem 2.1 to systems (S1) with f(x) =h(cos(x)) sin( x).\nIndeed, for such systems we can see that dynamics becomes a gradient ascent on the\npotential\nE(x) =X\ni,j\u03d5(cos(xi\u2212xj)), \u03d5 (t) =Zt\n0h(s)ds . (2)\nNote that a critical point xis locally unstable if and only if the Hessian at xhas positive\neigenvalue since the Hessian is symmetric, thus enabling application of Theorem 2.1. See\nTheorem 2.3 shortly, for the full statement.\n2.2 Adjusted gradient ascent\nIt turns out that the method discussed above is applicable not only to systems of the\ntype (S1), but also to more general systems with particle-dependent normalization factors,\ni.e. systems of the type (S2). We need to consider this extension because the the simplified\nmodel of self-attention (see (T2) below) has precisely such form.\nTheorem 2.3. Assume that f(x) = sin( x)h(cos(x)), where his a real-analytic function\non an open set containing [\u22121,1]and\u03c4R\u03c0\n\u2212\u03c0|f\u2032\u2032\u2032(x)|+dx\u22644\u0000\n1 +\u03c4\n2\u03c0\u0001\nf\u2032(0), where \u03c4is as\nin Theorem 2.1. Then, global synchronization occurs in (S2).\nThe full proof of this result is given in Section 4 below, but the idea is simple. First,\nwhen f(x) = sin( x)h(cos(x)) and normalization factors gi= 1, then as we have seen in\nthe previous section we are dealing with a gradient ascent on the potential (2), which thus\nmust converge (generically) to a locally stable critical point. In the case of gi\u0338= 1, we can\nfollow the idea suggested in [17, Section 3.4 and Remark B.1]: by introducing a non-flat\nRiemannian metric on ( S1)\u2297nwe can make sure that the gradient of the same energy (2)\n5\n\n--- Page 6 ---\nresults in the normalized dynamics (S2). Then, this case also reduces to an application\nof Theorem 2.1.\nWe mention that we further generalize the last result to systems where each parti-\ncle contributes to the RHS in (S2) with its own, particle-dependent weight factor. See\nSection 6 for more.\n2.3 Self-attention dynamics\nNext, we discuss an application of the main results to self-attention dynamics. Recall\nthat the latter [17, (USA)] is defined as\n\u02d9xi(t) =\u2212nX\nj=1e\u03b2cos(xi(t)\u2212xj(t))sin(xi(t)\u2212xj(t)),1\u2264i\u2264n, (T1)\nwhich corresponds to taking f(x) =f\u03b2(x) = sin( x)e\u03b2cos(x). The global synchronization\nconjectured in [17] for all \u03b2\u22650 was only shown for \u03b2\u22641 and \u03b2\u2265\u2126(1/n), cf. [11]. In\nthis section we resolve the conjecture in full and in fact even extend it to a portion of\n\u03b2 <0.\nDefine the number\na(\u03b2) = inf {\u03c4:f\u2032\n\u03b2(x)<0,\u2200x\u2208(\u03c4, \u03c0], \u03c4\u2208[0, \u03c0]}.\nTheorem 2.3 implies that whenever\n41 +a(\u03b2)\n2\u03c0\na(\u03b2)R\u03c0\n\u2212\u03c0|f\u2032\u2032\u2032(x)|+dx>1,\nglobal synchronization occurs. In fact, using specific properties of f\u03b2we can strengthen\nthe criterion in Theorem slightly, see Corollary 3.3 below, and guarantee global synchro-\nnization under the weaker assumption of\n41 +a(\u03b2)\n\u03c0\na(\u03b2)R\u03c0\n\u2212\u03c0|f\u2032\u2032\u2032(x)|+dx>1.\nThe quantity on the left-hand side is termed the synchronization ratio and we numerically\nplot it on Fig. 1. As one can see the criterion indeed is verified in the region of \u03b2\u2265 \u22120.25.\nWe formally verify the inequality in a slightly narrower region of \u03b2\u2265 \u22120.16 below.\nCorollary 2.4. Suppose \u03b2\u2265 \u22120.16. Then, global synchronization occurs in (T1).\nThe dynamics (T1) is a simplification of the actual self-attention dynamics, which is\ngiven by [17, (SA)]:\n\u02d9xi(t) =\u22121Pn\nj=1e\u03b2cos(xi(t)\u2212xj(t))nX\nj=1e\u03b2cos(xi(t)\u2212xj(t))sin(xi(t)\u2212xj(t)),1\u2264i\u2264n. (T2)\nAs already explained in the previous section (Theorem 2.3), the results about unnor-\nmalized system can be easily transported to results about the normalized system, which\nallows us to conclude with the following:\n6\n\n--- Page 7 ---\nFigure 1: The figure plots the synchronization ratio \u27e8|f\u2032\u2032\u2032|+, \u03c4\u27e9\u22121\nL24\u0000\n1 +\u03c4\n\u03c0\u0001\nf\u2032(0) from\nCorollary 3.3 with f(x) set as sin( x)e\u03b2(cos(x)\u22121)andMset as \u03c0. A ratio greater than\none indicates that we have determined that global synchronization occurs.\nCorollary 2.5. Suppose \u03b2\u2265 \u22120.16. Then, global synchronization occurs in (T2).\nFinally, one might wonder whether global synchronization occurs for even more neg-\native values of \u03b2. We show that this is not the case, thus leaving only the region\n\u03b2\u2208\u0000\n\u22122\n3,\u22120.25\u0001\nin uncertain synchronization status.\nCorollary 2.6. Suppose \u03b2 <\u22122\n3. There exists a constant C\u03b2such that if nis divisible\nby3orn\u2265C\u03b2, then global synchronization does not occur in either (T1) or(T2).\nThe proofs of all results can be found in Section 5.\nWe remark that for \u03b2 >0 self-attention dynamics (normalized or not) corresponds to\ngradient ascent on the potential\nE(x) =1\n\u03b2X\ni,je\u03b2cos(xi\u2212xj). (3)\nFor\u03b2 <0, self-attention dynamics is a gradient descent on the potential\nE(x) =1\n|\u03b2|X\ni,je\u2212|\u03b2|cos(xi\u2212xj).\nIn either case, the global optimizer is clearly the synchronized configuration. However,\nin the latter case local extrema with non-zero volume basin of attraction may emerge for\nlarge|\u03b2|.\nFinally, we remark that gradient descent on the potential (3) with \u03b2 > 0 yields a\ncompletely different dynamics, corresponding to taking f(x) =\u2212sin(x)e\u03b2cos(x)in (S1).\n7\n\n--- Page 8 ---\n\u22123 \u22122 \u22121 1 2 3 0f\u2032\n\u03b2\nf\u03b2\n(\u03c4,0)\n\u22120.50.51\nFigure 2: The function f\u03b2(red) and its derivative f\u2032\n\u03b2(blue) for \u03b2= 2. The parameter\n\u03c4=\u03c4(\u03b2) is defined as the unique solution to the equation f\u2032\n\u03b2(\u03c4) = 0 over [0 , \u03c0]. For \u03b2= 2,\n\u03c4\u22430.6749.\nIn this case the particles tend to equi-disperse on the circle. Indeed, the unique global\nminimizer of (3) is the n-gon as shown in [10]. At the level of the evolution of measures,\nthe unique global minimizer of the functions \u00b57\u2192R R\ne\u03b2cos(x\u2212y)\u00b5(dx)\u00b5(dy) can be easily\nseen to be the uniform measure (e.g. by noticing that Fourier coefficients of e\u03b2cos(x)are\nall positive, cf. [17, Section 7.2]), thus explaining the equidistribution tendency.\n3 Proof of Theorem 2.1\nSuppose x= (xi)1\u2264i\u2264n\u2208Tn. For the system (S1), a point is stationary iff\nnX\nj=1f(xi\u2212xj) = 0 ,\u2200i\u2208[n]. (C1)\nIn view of Lemma 2.2, we also need a condition for the point xto be stable. In fact,\nwe only need a weaker condition that is implied by stability, which has been the basis of\nproving synchronization in Kuramoto-type dynamics since its introduction in [33, (2.4)].\nWe say that point xiscut-stable if\nX\ni\u2208S, j\u2208SCf\u2032(xi\u2212xj)\u22650 (C2)\nfor all S\u2282[n] such that the value of xiis the same for all i\u2208S.\n8\n\n--- Page 9 ---\nOur proof will show that any stationary point satisfying (C2) must be synchronized. In\nother words, we will show that for any non-synchronized stationary point xthere exists a\nsetSdefining an \u201cescape direction\u201d for the linearization of the system (S1), corresponding\nto moving points in Sclockwise and points in Sccounter-clockwise at the same speed.2\nWe start with a review of the proof from [17] which applies to f(x) = f\u03b2(x) =\ne\u03b2cos(x)sin(x), whose derivative f\u2032\n\u03b2when \u03b2= 2 is shown in Fig. 2, where the crucial\nparameter \u03c4from Theorem 2.1 is also shown. If we apply (C2) with S={1}then we\nsee that there must be at least one particle, say 2, at distance \u2264\u03c4from 1 (otherwise all\nf\u2032(x1\u2212xj)<0). We can now apply the argument to S={1,2}to find that 3 must be at\ndistance \u2264\u03c4, etc. Overall, if n\u03c4 < \u03c0 then all particles must be inside one half-circle. But\nthen if i0is the boundary particle, then (C1) with i=i0implies that all xj=xi0, because\nf(xi0\u2212xj)\u22650. Unfortunately, this proof only shows synchronization when \u03c0 > n\u03c4 \u224dn\u221a\u03b2.\nOur contribution here is a method that extends to arbitrary large n.\nTo describe our idea, let us define the vector field acting on particles as\n\u03c7(x) =X\njf(x\u2212xj).\nThen from (C1) and (C2) (applied with S={i}) we know that\n\u03c7(xi) = 0 , \u03c7\u2032(xi)\u2265f\u2032(0).\nConsider a pair of adjacent particles xi< x i+1. Because \u03c7(xi) =\u03c7(xi+1), we have from\nintegration by parts that\n\u03c7\u2032(xi) +\u03c7\u2032(xi+1) =Zxi+1\nxi\u03c7\u2032\u2032\u2032(x)(x\u2212xi)(xi+1\u2212x)\nxi+1\u2212xidx .\nAs we have shown above, all intervals xi+1\u2212xiexcept possibly 1 are bounded by \u03c4. In the\nspecial case when all of them are bounded by \u03c4we can notice that the factor multiplying\n\u03c7\u2032\u2032\u2032(x) is positive and upper-bounded by \u03c4/2. Thus summing over i= 1, . . . , n \u22121 we\nobtain\n2nf\u2032(0)\u22642X\ni\u03c7\u2032(xi) =n\u22121X\ni=1Zxi+1\nxi\u03c7\u2032\u2032\u2032(x)(x\u2212xi)(xi+1\u2212x)\n(xi+1\u2212xi)dx\n\u2264\u03c4\n2Z\n|\u03c7\u2032\u2032\u2032(x)|+dx\u2264n\u03c4\n2Z\n|f\u2032\u2032\u2032|+dx .\nThis inequality, however, is not possible if (as is the case for f=f\u03b2for large \u03b2) we have\n\u03c4R\n|f\u2032\u2032\u2032|+<4f\u2032(0). Consequently, one of the assumptions must be violated. The full\nproof below will show that in fact this contradiction implies that x1=. . .=xn.\nWe proceed to the formal proof of Theorem 2.1 and consider x= (x1, . . . , x n) satisfying\nconditions (C1) and (C2). Denote the distinct values of the xias 0\u2264\u03b81< \u03b8 2<\u00b7\u00b7\u00b7<\n2Note that when state space is Sdwith d >1, then finding escape directions in mean-field systems\ncan be done by pulling all particles toward the same direction (subject to spherical constraints), cf. [26]\nand [11]. Our method is more involved.\n9\n\n--- Page 10 ---\n\u03b8K<2\u03c0and let \u03b8K+1= 2\u03c0+\u03b81. For 1 \u2264j\u2264K, we define \u2206 j=\u03b8j+1\u2212\u03b8j, where we set\n\u2206K= 2\u03c0+\u03b81\u2212\u03b8Kto account for the periodic boundary. We refer to the \u2206 jas the gaps.\nFurthermore, we let \u03c4max(x) denote the maximum of \u2206 jfor 1\u2264j\u2264K.\nLemma 3.1. Assume that (C2) is satisfied at (x1, . . . , x n). There do not exist distinct\ngaps \u03c91and\u03c92such that \u03c91, \u03c92> \u03c4.\nProof. The idea is the same as [17, Appendix B]. Suppose that the line \u2113intersects the\ninteriors of both \u03c91and\u03c92. Let Sbe the set of isuch that xiis on one side of \u2113. Then,\nfor all i\u2208Sandj\u2208SC, we have that xi\u2212xj/\u2208(\u2212min(\u03c91, \u03c92),min(\u03c91, \u03c92)) (mod 2 \u03c0).\nBecause min( \u03c91, \u03c92)> \u03c4,xi\u2212xj/\u2208[\u2212\u03c4, \u03c4] (mod 2 \u03c0), which implies that f\u2032(xi\u2212xj)<0.\nThis is a contradiction to (C2). \u25a0\nFori\u2208[K], let Nibe the multiplicity of \u03b8i, i.e. the number of j\u2208[n] such that\nxj=\u03b8i. Also, let\n\u27e8f, g\u27e9L2\u225cZ\u03c0\n\u2212\u03c0f(x)g(x)dx .\nLemma 3.2. Suppose (x1, . . . , x n)\u2208Tnis stationary (C1) and cut-stable (C2) for the\nsystem (S1). Furthermore, assume that (x1, . . . , x n)is not synchronized. Then,\n\u27e81,|f\u2032\u2032\u2032|+\u27e9L2\u2265min\u00128\n\u03c4,4\n\u03c4+4\n\u03c4max(x1, . . . , x n)\u0013\nf\u2032(0).\nProof. For the sake of contradiction, assume that K > 1. Let\n\u03c6(x) =nX\nj=1f\u2032(x\u2212xj).\nThen, after using (C2) with Sequal to the set of j\u2208[n] such that xj=\u03b8i,\n\u03c6(\u03b8i) =Nif\u2032(0) +X\nj\u2208[n], xj\u0338=\u03b8if\u2032(\u03b8i\u2212xj)\u2265Nif\u2032(0). (4)\nLet\n\u03a8 =KX\ni=11{x\u2208(\u03b8i, \u03b8i+1)}\u03a8i,\nwhere \u03a8 i: [\u03b8i, \u03b8i+1]\u2192Ris twice differentiable. Then, for i\u2208[K],\n\u27e8\u03a8i, \u03c6\u2032\u2032\u27e9L2= \u03a8 i\u03c6\u2032\f\f\u03b8i+1\n\u03b8i\u2212 \u27e8\u03a8\u2032\ni, \u03c6\u2032\u27e9L2= (\u03a8 i\u03c6\u2032\u2212\u03a8\u2032\ni\u03c6)\f\f\u03b8i+1\n\u03b8i+\u27e8\u03a8\u2032\u2032\ni, \u03c6\u27e9L2.\nAssume that \u03a8\u2032\u2032\ni=\u2212aifor a constant aiand \u03a8 i(\u03b8i) = \u03a8 i(\u03b8i+1) = 0 over [ \u03b8i, \u03b8i+1], or\nequivalently that \u03a8 i(x) =ai\n2(x\u2212\u03b8i)(\u03b8i+1\u2212x). Then, we have that\n\u27e8\u03a8i, \u03c6\u2032\u2032\u27e9L2=\u2212\u03a8\u2032\ni(\u03b8i+1)\u03c6(\u03b8i+1) + \u03a8\u2032\ni(\u03b8i)\u03c6(\u03b8i)\u2212ai\u27e81{(\u03b8i, \u03b8i+1)}, \u03c6\u27e9L2\n10\n\n--- Page 11 ---\n=ai\n2\u2206i(\u03c6(\u03b8i) +\u03c6(\u03b8i+1)),\nsinceZ\u03b8i+1\n\u03b8i\u03c6(x)dx=nX\nj=1f(\u03b8i+1\u2212xj)\u2212nX\nj=1f(\u03b8i\u2212xj) = 0 .\nHence,\n\u27e8\u03a8, \u03c6\u2032\u2032\u27e9L2=KX\ni=1ai\n2\u2206i(\u03c6(\u03b8i) +\u03c6(\u03b8i+1)).\nIn particular, assuming that ai\u22650 for all i\u2208[K], using (4) gives that\n\u27e8\u03a8, \u03c6\u2032\u2032\u27e9L2\u2265KX\ni=1ai\n2\u2206i(Ni+Ni+1)f\u2032(0).\nFurthermore, since \u03a8 i\u2208[0,ai\u22062\ni\n8], we have that\n*KX\ni=1ai\u22062\ni1{(\u03b8i, \u03b8i+1)},|\u03c6\u2032\u2032|++\nL2\u22654KX\ni=1ai\u2206i(Ni+Ni+1)f\u2032(0).\nSincePn\nj=1|f\u2032\u2032\u2032(x\u2212xj)|+\u2265 |\u03c6\u2032\u2032|+, we have that\nnX\nj=1*KX\ni=1ai\u22062\ni1{(\u03b8i, \u03b8i+1)},|f\u2032\u2032\u2032(x\u2212xj)|++\nL2\u22654KX\ni=1ai\u2206i(Ni+Ni+1)f\u2032(0),\nor equivalently,\nnX\nj=1*KX\ni=1ai\u2206i1{(\u03b8i, \u03b8i+1)},|f\u2032\u2032\u2032(x\u2212xj)|++\nL2\u22654KX\ni=1ai(Ni+Ni+1)f\u2032(0). (5)\nBy Lemma 3.1, we can have that \u03c4max(x1, . . . , x n) is greater than \u03c4, but all other gaps\nmust be at most \u03c4. For brevity, we use \u03c4maxto denote \u03c4max(x1, . . . , x n) in the remainder\nof the proof.\nIn (5), set ai=1\n\u2206ito obtain\nnX\nj=1*KX\ni=11{(\u03b8i, \u03b8i+1)},|f\u2032\u2032\u2032(x\u2212xj)|++\nL2\u22654KX\ni=1Ni+Ni+1\n\u2206if\u2032(0)\n\u21d4n\u27e81,|f\u2032\u2032\u2032|+\u27e9L2\u22654KX\ni=1Ni+Ni+1\n\u2206if\u2032(0).\nAssume that the gap \u03c4maxis between \u03b8\u2113and\u03b8\u2113+1. Since \u2206 i\u2264\u03c4fori\u2208[K]\\{\u2113},\nn\u27e81,|f\u2032\u2032\u2032|+\u27e9L2\u22654\uf8eb\n\uf8edX\ni\u2208[K]\\{\u2113}Ni+Ni+1\n\u03c4+N\u2113+N\u2113+1\n\u03c4max\uf8f6\n\uf8f8f\u2032(0)\n11\n\n--- Page 12 ---\n= 4\u00122n\n\u03c4\u2212(N\u2113+N\u2113+1)\u00b7\u00121\n\u03c4\u22121\n\u03c4max\u0013\u0013\nf\u2032(0).\nThe result follows after noting that N\u2113+N\u2113+1\u2264nbecause K\u22652. \u25a0\nCorollary 3.3. Let\u03c4\u2208(0, \u03c0]be such that f\u2032(x)<0for all x\u0338\u2208[\u2212\u03c4, \u03c4]. Assume that M\nis a positive real number such that for all stable, stationary, and non-synchronized points\nxof (S1), \u03c4max(x)< M . If\n\u03c4Z\u03c0\n\u2212\u03c0|f\u2032\u2032\u2032(x)|+dx\u22644\u0010\n1 +\u03c4\nM\u0011\nf\u2032(0),\nthen every stable stationary point (x1, . . . , x n)of system (S1) onTnis synchronized, i.e.\nx1=\u00b7\u00b7\u00b7=xn.\nNote that Corollary 3.3 is more general than Theorem 2.1 since M= 2\u03c0is always a\nvalid choice.\nProof. From Lemma 3.2, if x= (x1, . . . , x n) is not synchronized, then\n\u27e81,|f\u2032\u2032\u2032|+\u27e9L2\u2265min\u00128\n\u03c4,4\n\u03c4+4\n\u03c4max(x)\u0013\nf\u2032(0)>4\u00121\n\u03c4+1\nM\u0013\nf\u2032(0)\nbecause \u03c4max(x)< M, which is a contradiction. \u25a0\nRemark 3.4.In many cases, such as the Kuramoto model and self-attention dynamics,\nit is straightforward to show that \u03c4max(x)< \u03c0 forxto be stable, stationary, and non-\nsynchronized, which leads to an improvement upon Theorem 2.1 by setting M=\u03c0in\nCorollary 3.3. For examples of such results, see [17, Lemma 6.4] and [11, Lemma 10].\nCorollary 3.5. Assume that f\u2032(0)\u22650and\u03c4\u27e81,|f\u2032\u2032\u2032|+\u27e9L2\u22644\u0000\n1 +\u03c4\n2\u03c0\u0001\nf\u2032(0). Suppose\na, b\u2208Rsatisfy ab\u22650andaandbare not both zero. Assume that\nnX\nj=1af(xi\u2212xj)\u2212bf(xj\u2212xi) = 0 ,\u2200i\u2208[n] (6)\nand (C2) are satisfied at (x1, . . . , x n). Then, xi=xjfor all i, j\u2208[n].\nProof. Letg(x) =|a|f(x)\u2212 |b|f(\u2212x). Then, g\u2032(x) =|a|f\u2032(x) +|b|f\u2032(\u2212x) and g\u2032\u2032\u2032(x) =\n|a|f\u2032\u2032\u2032(x)+|b|f\u2032\u2032\u2032(\u2212x). We have that gsatisfies (C1) and (C2) at ( x1, . . . , x n). Furthermore,\ng\u2032(0) = ( |a|+|b|)f\u2032(0)\u22650 and |g\u2032\u2032\u2032(x)|+\u2264 |a||f\u2032\u2032\u2032(x)|++|b||f\u2032\u2032\u2032(\u2212x)|+so\u03c4\u27e81,|g\u2032\u2032\u2032|+\u27e9L2\u2264\n\u03c4(|a|+|b|)\u27e81,|f\u2032\u2032\u2032|+\u27e9L2\u22644\u0000\n1 +\u03c4\n2\u03c0\u0001\ng\u2032(0). The result follows from Theorem 2.1. \u25a0\n12\n\n--- Page 13 ---\n4 Gradient ascent systems\nThe goal of this section is to prove Theorem 2.3, which characterizes the asymptotic\nbehavior of (adjusted) mean-field gradient ascent systems. Following the statement of\nthe theorem, assume that f(x) = sin( x)h(cos(x)) for some real-analytic function hon an\nopen set containing [ \u22121,1]; recall that g: (S1)n\u2192R>0is smooth.\nAs explained in Lemma 2.2, gradient ascent almost always converges to a stationary\npoint. The key idea of the proof is to use Lemma 2.2 to argue that the stationary\npoint almost always has negative semi-definite Hessian and then apply Theorem 2.1 to\ncharacterize the stationary point as being synchronized. As part of the proof, we show\nthat a stationary point with negative semi-definite Hessian satisfies conditions (C1) and\n(C2) so that we can apply Theorem 2.1.\nWe rewrite (S2) in terms of points on the manifold ( S1)n. Note that this is the setting\nthat [17, 16] originally consider. For i\u2208[n] and t\u22650, let\npi(t) = (cos( xi(t)),sin(xi(t)))\u2208S1.\nFor a point pi\u2208S1let us introduce p\u22a5\nito be (the unique) positively oriented unit vector\nin the tangent space at pi. Let us denote by Pp\u22a5\ni(\u00b7) the linear operator orthogonally\nprojecting R2onto the span of p\u22a5\ni. With this notation we can rewrite (S2) as\n\u02d9pi(t) =1\ngi(p(t))nX\nj=1h(\u27e8pi(t),pj(t)\u27e9)Ppi(t)\u22a5(pj(t))\u2200i\u2208[n], (S2\u2019)\nwhere p(t) = ( p1(t), . . . , pn(t))\u2208(S1)nfort\u22650. To see the equivalence, note that\nPpi(t)\u22a5pj(t) =\u2212sin(xi(t)\u2212xj(t))pi(t)\u22a5and\u27e8pi(t),pj(t)\u27e9= cos( xi(t)\u2212xj(t)).\nNext, we rewrite (S2\u2019) as the gradient of a function over a Riemannian manifold.\nSuppose \u03c6(x) =Rx\n0h(x)dx, which is also an analytic function. Let\nE(x1, . . . , x n) =1\n2nX\ni,j=1\u03c6(\u27e8xi, xj\u27e9).\nIn order to describe the system as gradient ascent, we construct a Riemannian manifold\nsuch that the gradient computed with respect to its metric is the dynamics of (S2\u2019). We\nfollow the ideas of [17, Section 3.4] to state and prove the following lemma.\nLemma 4.1. Suppose the Riemannian manifold Mover (S1)nhas positive-definite inner\nproduct \u27e8(a1, . . . , a n),(b1, . . . , b n)\u27e9P=Pn\ni=1\u03b1i(P)aibiatP= (p1, . . . , p n)\u2208(S1)n. Then,\n(\u2207M)iE(P) =1\n\u03b1i(P)nX\nj=1h(\u27e8pi, pj\u27e9)Pp\u22a5\ni(pj)\u2200i\u2208[n].\nProof. LetYbe a vector field over ( S1)nwith gradient flow \u03a6t\nY. Furthermore, suppose\nthe vector field Bsatisfies\nBi(P) =1\n\u03b1i(P)nX\nj=1h(\u27e8pi, pj\u27e9)PP\u22a5\ni(Pj)\n13\n\n--- Page 14 ---\nfori\u2208[n]. Then, it suffices to prove that\nd\ndt\f\f\f\f\nt=0E(\u03a6t\nY(P)) =\u27e8Y(P), B(P)\u27e9P.\nBy considering a linear basis over TP(S1)n, we only need to show this holds when\nY(P) = (Ap1,0, . . . , 0) for a non-zero skew symmetric A. In this case, \u03a6t\nY(P) = (eAtp1, p2,\n. . . , p n), so\nE(\u03a6t\nY(P)) =X\nj\u0338=1\u03c6(\neAtp1, pj\u000b\n) +1\n2\u03c6(\neAtp1, eAtp1\u000b\n) +C,\nwhere Cdoes not depend on t. Thus,\nd\ndtE(\u03a6t\nY(P)) =X\nj\u0338=1h(\neAtp1, pj\u000b\n)\nAeAtp1, pj\u000b\n+h(\neAtp1, eAtp1\u000b\n)\nAeAtp1, p1\u000b\n\u21d2d\ndt\f\f\f\f\nt=0E(\u03a6t\nY(P)) =nX\nj=1h(\u27e8p1, pj\u27e9)\u27e8Ap1, pj\u27e9.\nIt suffices to prove that\nnX\nj=1h(\u27e8p1, pj\u27e9)\u27e8Ap1, pj\u27e9=\u27e8Y(P), B(P)\u27e9P=*\nAp1,nX\nj=1h(\u27e8p1, pj\u27e9)Pp\u22a5\n1(pj)+\n.\nHence, it suffices to prove that for all v\u2208S1,\n\u27e8Ap1, v\u27e9=D\nAp1, Pp\u22a5\n1(v)E\n=\u27e8Ap1, v\u2212 \u27e8v, p1\u27e9p1\u27e9,\nwhich would be implied by \u27e8Ap1, p1\u27e9= 0. Observe that \u27e8Ap1, p1\u27e9=p\u22a4\n1Ap1, which equals\n0 because Ais skew-symmetric. \u25a0\nLemma 2.2 implies the almost always convergence to a critical point of Ewith a\nnegative semidefinite Hessian. However, as explained in [17, Remark B.1], when analyzing\nwhether the Hessian is negative semidefinite at a critical point, any two metrics are\nequivalent. We state this classical idea in the following lemma, and afterwards, we use it\nto prove the main result.\nLemma 4.2. Suppose R1= ((Sd\u22121)n, g1)andR2= ((Sd\u22121)n, g2)are Riemannian mani-\nfolds. Let Pbe a critical point of the analytic function \u03b3: (Sd\u22121)n\u2192R. For 1\u2264i\u22642,\nletHibe the Hessian of \u03b3atPwith respect to Ri. Suppose v\u2208TP((Sd\u22121)n). Then,\n\u27e8H1v, v\u27e9R1>0\u21d4 \u27e8H2v, v\u27e9R2>0.\nRemark 4.3.The set of critical points for both metrics are the same. We abuse notation\nand assume that Hiis a matrix expressing the Hessian in terms of an orthonormal basis\nfor the metric RiatP, and thus write v\u22a4Hivinstead of \u27e8Hiv, v\u27e9Ri, implying that v\u2208TP\nis itself expressed as a column vector in the orthonormal basis with respect to RiatP.\n14\n\n--- Page 15 ---\nProof of Theorem 2.3. For this proof, we are working in the setting of points on ( S1)n\nthat we have introduced in this section. Let Rbe the Riemannian manifold over ( S1)n\nwith positive-definite inner product \u27e8(a1, . . . , a n),(b1, . . . , b n)\u27e9P=Pn\ni=1gi(P)aibiatP.\nThen, from Lemma 4.1 with \u03b1i=gifor all i\u2208[n],\n\u02d9p(t) =\u2207RE(p(t))\nin (S2\u2019). Applying Lemma 2.2 gives that we have almost-sure convergence to a critical\npoint P= (p1, . . . , p n) with negative semi-definite Hessian. Then, if His the Hessian of\nEatPwith respect to Rand expressed in terms of an orthonormal basis for the metric\n\u27e8\u00b7,\u00b7\u27e9P, we assume that there does not exist v\u2208TP((S1)n) such that v\u22a4Hv > 0.\nFirst, observe that for all i\u2208[n],\nnX\nj=1h(\u27e8pi, pj\u27e9)Pp\u22a5\ni(pj) = 0\nby the definition of a critical point of (S2\u2019), which can in turn be rewritten asP\njh(cos(xi\u2212\nxj)) sin( xj\u2212xi) =P\njf(xj\u2212xi) = 0, thus verifying condition (C1).\nLetSbe the Riemannian manifold over ( S1)nwith the standard inner product. Let\nHSbe the Hessian of EatPwith respect to Sand expressed in terms of the standard\northonormal basis. By applying Lemma 4.2 with the Riemannian manifolds RandSand\nthe function Eas\u03b3, because there does not exist v\u2208TP(S1)n) such that v\u22a4Hv > 0, there\ndoes not exist v\u2208TP((S1)n) such that v\u22a4HSv >0.\nThe next step is to show that P, when written as an element of Tn, is cut-stable,\ncf. (C2), so that we can apply Theorem 2.1. For this purpose, we follow the method of\n[17, Appendix A].\nFort\u22650, define\np(t) = [eciBtpi]i\u2208[n],\nwhere B=\u00120\u22121\n1 0\u0013\nis skew-symmetric. First, observe that\nE(p(t)) =X\ni,j\u2208[n],i\u0338=j\u03c6(\neciBtpi, ecjBtpj\u000b\n) +C,\nwhere Cdoes not depend on t.\nSuppose we let v=d\ndt\f\f\nt=0p(t). Observe that vi=ciBpifor all i\u2208[n], sov\u2208TP((S1)n).\nThen,\nd2\ndt2\f\f\f\nt=0E(p(t)) =v\u22a4HSv\u22640. (7)\nNext, where h(x) =d\ndx\u03c6(x),\nd\ndtE(p(t)) =X\ni,j\u2208[n],i\u0338=jh(\neciBtpi, ecjBtpj\u000b\n)\u0000\nciBeciBtpi, ecjBtpj\u000b\n+\neciBtpi, cjBecjBtpj\u000b\u0001\n.\n15\n\n--- Page 16 ---\nFurthermore,\nd2\ndt2E(p(t)) =X\ni,j\u2208[n],i\u0338=j\u0014\nh\u2032(\neciBtpi, ecjBtpj)\u000b\n)\u0000\nciBeciBtpi, ecjBtpj\u000b\n+\neciBtpi, cjBecjBtpj\u000b\u00012\n+h(\neciBtpi, ecjBtpj)\u000b\n)\u00d7\u0012\nc2\niB2eciBtpi, ecjBtpj\u000b\n+\nciBeciBtpi, cjBecjBtpj\u000b\n+\neciBtpi, c2\njB2ecjBtpj\u000b\u0013\u0015\nFor 1 \u2264i\u2264n, let xibe the unique element of Tsuch that pi= (cos( xi),sin(xi)).\nBecause B2=\u2212I2,\u27e8B2pi, pj\u27e9=\u2212cos(xi\u2212xj). Since Bis the rotation by 90\u25e6matrix,\n\u27e8Bpi, pj\u27e9= cos( xi+ 90\u2212xj) = sin( xj\u2212xi). Thus,\nd2\ndt2\f\f\f\f\nt=0E(p(t))\n=X\ni,j\u2208[n],i\u0338=j(ci\u2212cj)2(\u2212cos(xi\u2212xj)h(cos(xi\u2212xj)) + sin( xi\u2212xj)2h\u2032(cos(xi\u2212xj))).\nSinced2\ndt2\f\f\nt=0E(p(t))\u22640 by (7),\nX\ni,j\u2208[n],i\u0338=j(ci\u2212cj)2(cos(xi\u2212xj)h(cos(xi\u2212xj))\u2212sin(xi\u2212xj)2h\u2032(cos(xi\u2212xj)))\u22650.\nObserve that because f(x) = sin( x)h(cos(x)),f\u2032(x) = cos( x)h(cos(x))\u2212sin(x)2h\u2032(cos(x)).\nTherefore,X\ni,j\u2208[n](ci\u2212cj)2f\u2032(xi\u2212xj)\u22650,\nso (C2) is satisfied by setting ci=1{i\u2208S}forS\u2282[n]. Then, by Theorem 2.1, the xi\nare synchronized, which finishes the proof. \u25a0\nRemark 4.4.Observe that we have shown that if the critical point Phas negative semi-\ndefinite Hessian, thenX\ni,j\u2208[n](ci\u2212cj)2f\u2032(xi\u2212xj)\u22650\nfor all ci, cj\u2208R. This result is well-known, but we include the computations for com-\npleteness. The other direction is true as well, since for any v\u2208TP((S1)n), we have that\nvi=ciBpifor some ci\u2208Rfor all i\u2208[n].\n16\n\n--- Page 17 ---\n5 Application to self-attention dynamics\nIn this section, we prove Corollary 2.4, Corollary 2.5 and Corollary 2.6.\nProof of Corollary 2.4. For\u03b2\u22650, system (T1) is equivalent to (S1) with f(x) = sin( x)\ne\u03b2(cos(x)\u22121)andg= 1. By Theorem 2.3, it suffices to show that \u03c4\u27e81,|f\u2032\u2032\u2032|+\u27e9<4f\u2032(0). We\nprove this by considering cases for \u03b2.\nFirst, observe that\nf\u2032(x) = (cos( x)\u2212\u03b2sin(x)2)e\u03b2(cos(x)\u22121),\nf\u2032\u2032(x) = (\u2212sin(x)\u22123\u03b2sin(x) cos( x) +\u03b22sin(x)3)e\u03b2(cos(x)\u22121),\nf\u2032\u2032\u2032(x) =\u2212(cos(x) + 3\u03b2cos(x)2\u22124\u03b2sin(x)2\u22126\u03b22cos(x) sin(x)2+\u03b23sin(x)4)e\u03b2(cos(x)\u22121).\nWe reference these expressions later. Furthermore, it is clear that we can set\n\u03c4= arccos p\n1 + 4 \u03b22\u22121\n2\u03b2!\n.\nCase of \u03b2 >1\n3.The positive regions of f\u2032\u2032\u2032over (\u2212\u03c0, \u03c0] are (\u2212a,\u2212b)\u222a(b, a) for some\na, bsuch that 0 < a < b < \u03c0 , see Lemma A.1. Since f\u2032\u2032\u2032is even, it suffices to prove that\n\u27e8\u03c4,1{(\u2212a,\u2212b)\u222a(b, a)}f\u2032\u2032\u2032\u27e9<4\u21d4\u03c4(f\u2032\u2032(a)\u2212f\u2032\u2032(b))<2,\nwhich follows from Lemma A.4, Lemma A.5, Lemma A.6, and Lemma A.7.\nCase of 0< \u03b2\u22641\n3.The positive region of f\u2032\u2032\u2032over [0 ,2\u03c0) is ( a,2\u03c0\u2212a) for some\na\u2208(0,\u03c0\n2), see Lemma B.1. Then, it suffices to prove that\n\u27e8\u03c4,1{(a,2\u03c0\u2212a)}f\u2032\u2032\u2032\u27e9<4\u21d4\u03c4f\u2032\u2032(a)>\u22122,\nwhich is proved in Lemma B.4.\nCase of \u03b2= 0.This corresponds to the Kuramoto model. In this case, f\u2032(x) = cos( x)\nand\u03c4=\u03c0\n2, because if x\u2208(\u03c0\n2,3\u03c0\n2) then f\u2032(x) is negative. Then, f\u2032\u2032(x) =\u2212sin(x)\nandf\u2032\u2032\u2032(x) =\u2212cos(x) has positive region (\u03c0\n2,3\u03c0\n2) in [0 ,2\u03c0). Using the notation for the\n\u03b2\u2208(0,1\n3] case, a=\u03c0\n2and it suffices to prove that \u03c4f\u2032\u2032(a)>\u22122, which is true because\n\u03c4f\u2032\u2032(a) =\u2212\u03c0\n2>\u22122.\nCase of \u22120.16\u2264\u03b2 < 0.From Lemma C.4, we may set M=\u03c0in Corollary 3.3.\nAfterwards, we prove that global synchronization occurs in (T1) by applying Corollary 3.3\nwith M=\u03c0andgi= 1 for all i. By setting gi(x1, . . . , x n) =Pn\nj=1e\u03b2cos(xi\u2212xj), we also\nshow that global synchronization occurs in (T2).\nBy Corollary 3.3, it suffices to prove that \u03c4\u27e81,|f\u2032\u2032\u2032|+\u27e9 \u22644\u0000\n1 +\u03c4\n\u03c0\u0001\n. The positive region\noff\u2032\u2032\u2032over (\u2212\u03c0, \u03c0] is (a,2\u03c0\u2212a) for some a\u2208(\u03c0\n2, \u03c0), see Lemma C.1. Since f\u2032\u2032\u2032is even, it\nsuffices to prove that\n\u27e8\u03c4,1{(a,2\u03c0\u2212a)}f\u2032\u2032\u2032\u27e9 \u22644\u0010\n1 +\u03c4\n\u03c0\u0011\n\u21d4\u03c4f\u2032\u2032(a)\u22652\u0010\n1 +\u03c4\n\u03c0\u0011\n,\nwhich follows from Lemma C.5. \u25a0\n17\n\n--- Page 18 ---\nProof of Corollary 2.5. This follows from the same argument as the proof of Corollary 2.4\nbut with gi(x1, . . . , x n) =Pn\nj=1e\u03b2cos(xi\u2212xj)fori\u2208[n] in (S2), which is a smooth function.\n\u25a0\nProof of Corollary 2.6. From Lemma C.6, if \u03b2 <\u22122\n3andnis divisible by three or nis\nsufficiently large, then there exists a stable nonsynchronized stationary point. At this\npoint, the Hessian has one zero eigenvalue which corresponds to translating each point\nby the same displacement and its other eigenvalues are negative. This implies that global\nsynchronization does not occur. \u25a0\n6 Generalized system\nOne of the extensions following Kuramoto\u2019s work was introduced by [33] in the following\nform:\n\u02d9xi(t) =\u2212nX\nj=1ai,jf(xi(t)\u2212xj(t)),\u2200i\u2208[n], (8)\nwhere A= (ai,j)1\u2264i,j\u2264n\u2208Rn\u00d7nis a weight matrix and f:T\u2192Ris an interaction\nfunction. Taylor [33] showed synchronization result for f(x) = sin( x) and Abeing an\nadjacency matrix of an (undirected) graph with each vertex having degree \u22650.94n. Sub-\nsequent works eventually improved the lower bound on degree to 0 .75n[22], while also\nshowing graphs with each vertex of degree \u22650.6838n, which do not synchronize [37].\nIt is conjectured that there exists graphs with min-degree approaching 0 .75nwhich do\nnot synchronize. Furthermore, expander graphs have been utilized to show that generat-\ningAusing a random process of adding edges leads to global synchronization once Ais\nconnected [1, 20].\nIn this section, we will extend our criterion to the special case of rank-1 matrices A.\nInitially, we will only consider the following version:\n\u02d9xi(t) =\u2212nX\nj=1cjf(xi(t)\u2212xj(t)),\u2200i\u2208[n], (S3)\nwhere cj>0 for 1 \u2264j\u2264n. This system generalizes (S1) by allowing different weights\nfor each particle. We now state the analogous stationarity and cut-stability conditions.\nSuppose x= (xi)1\u2264i\u2264n\u2208Tn. For the system (S3) a point is stationary iff\nnX\nj=1cjf(xi\u2212xj) = 0 ,\u2200i\u2208[n]. (C3)\nWe say that point xiscut-stable if\nX\ni\u2208S, j\u2208SCcjf\u2032(xi\u2212xj)\u22650 (C4)\n18\n\n--- Page 19 ---\nfor all S\u2282[n] such that the value of xiis the same for all i\u2208S.\nWe state the following result, which generalizes Corollary 3.3. Note that Theorem 2.1\nis an implication of this corollary.\nTheorem 6.1. Assume that Mis a positive real number such that for all stable, station-\nary, and non-synchronized points xof (S3), \u03c4max(x)< M . If\n\u03c4Z\u03c0\n\u2212\u03c0|f\u2032\u2032\u2032(x)|+dx\u22644\u0010\n1 +\u03c4\nM\u0011\nf\u2032(0),\nthen every stationary and stable point (x1, . . . , x n)of system (S3) onTnis synchronized,\ni.e.x1=\u00b7\u00b7\u00b7=xn, where \u03c4is as in Theorem 2.1.\nProof. The same proof of Theorem 2.1 in Section 3 can be used, except with \u03a8( x)\u225cPn\nj=1cjf\u2032(x\u2212xj) and Wi\u225cP\nj\u2208[n]:xj=\u03b8icjreplacing Ni. Similarly, we only require (C4)\nfor the proof. \u25a0\nIt is not immediately clear that global synchronization occurs in this setting, since we\nno longer have an obvious gradient ascent structure. First, we normalize (S3).\nAssume that g:Tn\u2192Rn\n>0is smooth. Then, we can normalize the system as\n\u02d9xi(t) =\u22121\ngi(x1(t), . . . , x n(t))nX\nj=1cjf(xi(t)\u2212xj(t)),1\u2264i\u2264n, (S4)\nwhich allows us to state the following result, which generalizes Theorem 2.3 and is stated\nin the format of Corollary 3.3.\nTheorem 6.2. Assume that f(x) = sin( x)h(cos(x)), where his a real-analytic function\non an open set containing [\u22121,1]. Assume that Mis a positive real number such that for\nall stable, stationary, and non-synchronized points xof (S4), \u03c4max(x)< M . Furthermore,\nassume that \u03c4\u27e81,|f\u2032\u2032\u2032|+\u27e9 \u22644\u0000\n1 +\u03c4\nM\u0001\nf\u2032(0), where \u03c4is as in Theorem 2.1. Then, global\nsynchronization occurs in (S2).\nSimilarly to the approach of Section 4, we express the dynamical system in terms of\npoints on ( S1)n. For i\u2208[n] and t\u22650, we let pi(t) = (cos( xi(t)),sin(xi(t))) to obtain the\nequivalent dynamical system\n\u02d9pi(t) =1\ngi(p(t))nX\nj=1cjh(\u27e8pi(t),pj(t)\u27e9)Ppi(t)\u22a5(pj(t))\u2200i\u2208[n], (S4\u2019)\nwhere p(t) = ( p1(t), . . . , pn(t))\u2208(S1)nfort\u22650.\nSuppose \u03c6(x) =Rx\n0h(x)dxand let\nEw(x1, . . . , x n) =1\n2nX\ni,j=1cicj\u03c6(\u27e8xi, xj\u27e9).\nNote that this energy function is also considered in [11]. The idea is that the cicorrespond\nto the weights of the particles. We have the following generalization of Lemma 4.1. The\nresult can be proved using the same approach.\n19\n\n--- Page 20 ---\nLemma 6.3. Suppose the Riemannian manifold Mover (S1)nhas positive-definite inner\nproduct \u27e8(a1, . . . , a n),(b1, . . . , b n)\u27e9P=Pn\ni=1\u03b1i(P)aibiatP= (p1, . . . , p n)\u2208(S1)n. Then,\n(\u2207M)iEw(P) =1\n\u03b1i(P)nX\nj=1cicjh(\u27e8pi, pj\u27e9)Pp\u22a5\ni(pj)\u2200i\u2208[n].\nProof of Theorem 6.2. The same proof as the proof of Theorem 2.3 can be used. The only\ndifferences are as follows. The Riemannian manifold Rover (S1)nhas positive-definite in-\nner product \u27e8(a1, . . . , a n),(b1, . . . , b n)\u27e9P=Pn\ni=1cigi(P)aibiatP. Of course, (S4\u2019) replaces\n(S2\u2019), and we implement the remaining analogous replacements; for example, we replace\n(C1) and (C2) with (C3) and (C4), respectively, as well as Theorem 2.1 with Theorem 6.1.\nWhen verifying that (C4) is true, the final expression we obtain is that for S\u2282[n]\nsuch that the xiare all equal to \u03b8fori\u2208S,\nX\ni\u2208S,j /\u2208Scicjf\u2032(xi\u2212xj)\u22650\u21d4 X\ni\u2208Sci!X\nj /\u2208Scjf\u2032(\u03b8\u2212xj)\u22650.\nNote that (C4) is clearly true when Sis empty. If Sis nonempty, since the ciare positive\nwe have thatP\nj /\u2208Scjf\u2032(\u03b8\u2212xj)\u22650, so (C4) holds. \u25a0\nAn important implication of Theorem 6.2 is the following result, which allows the\nsetting of Aasw1w\u22a4\n2in (8) while still having global synchronization.\nCorollary 6.4. Assume that fsatisfies the conditions of Theorem 6.2, where (S4) is\nreplaced by the system\n\u02d9xi(t) =\u2212nX\nj=1w1iw2jf(xi(t)\u2212xj(t)),1\u2264i\u2264n,\nwhere w1i, w2i>0for1\u2264i\u2264nare fixed. Then, global synchronization occurs in this\nsystem.\nProof. This follows from Theorem 6.2 with gi=w\u22121\n1iandci=w2ifor 1\u2264i\u2264n. \u25a0\nReferences\n[1] Pedro Abdalla, Afonso S. Bandeira, Martin Kassabov, Victor Souza, Steven H. Stro-\ngatz, and Alex Townsend. Expander graphs are globally synchronizing. arXiv preprint\narXiv:2210.12788 , 2024.\n[2]\u00b4Alvaro Rodr\u00b4 \u0131guez Abella, Jo\u02dc ao Pedro Silvestre, and Paulo Tabuada. The asymptotic\nbehavior of attention in transformers. arXiv preprint arXiv:2412.02682 , 2024.\n[3] Juan A Acebr\u00b4 on, Luis L Bonilla, Conrad J P\u00b4 erez Vicente, F\u00b4 elix Ritort, and Renato\nSpigler. The Kuramoto model: A simple paradigm for synchronization phenomena.\nReviews of Modern Physics , 77(1):137\u2013185, 2005.\n20\n\n--- Page 21 ---\n[4] Vincent D Blondel, Julien M Hendrickx, Alex Olshevsky, and John N Tsitsiklis.\nConvergence in multiagent coordination, consensus, and flocking. In Proceedings of\nthe 44th IEEE Conference on Decision and Control , pages 2996\u20133000. IEEE, 2005.\n[5] Nicolas Boumal. An introduction to optimization on smooth manifolds . Cambridge\nUniversity Press, 2023.\n[6] Giuseppe Bruno, Federico Pasqualotto, and Andrea Agazzi. Emergence of meta-\nstable clustering in mean-field transformer models. In The Thirteenth International\nConference on Learning Representations , 2025.\n[7] Martin Burger, Samira Kabri, Yury Korolev, Tim Roith, and Lukas Weigand. Anal-\nysis of mean-field models arising from self-attention dynamics in transformer archi-\ntectures with layer normalization. arXiv preprint arXiv:2501.03096 , 2025.\n[8] Val\u00b4 erie Castin, Pierre Ablin, Jos\u00b4 e Antonio Carrillo, and Gabriel Peyr\u00b4 e. A unified\nperspective on the dynamics of deep transformers. arXiv preprint arXiv:2501.18322 ,\n2025.\n[9] Shi Chen, Zhengjiang Lin, Yury Polyanskiy, and Philippe Rigollet. Quantitative\nclustering in mean-field transformer models. arXiv preprint arXiv:2504.14697 , 2025.\n[10] Henry Cohn and Abhinav Kumar. Universally optimal distribution of points on\nspheres. Journal of the American Mathematical Society , 20(1):99\u2013148, 2007.\n[11] Christopher Criscitiello, Quentin Rebjock, Andrew D. McRae, and Nicolas Boumal.\nSynchronization on circles and spheres with nonlinear interactions. arXiv preprint\narXiv:2405.18273 , 2024.\n[12] Gb` etondji JS Dovonon, Michael M Bronstein, and Matt J Kusner. Setting the record\nstraight on transformer oversmoothing. arXiv preprint arXiv:2401.04301 , 2024.\n[13] Ruili Feng, Kecheng Zheng, Yukun Huang, Deli Zhao, Michael Jordan, and Zheng-\nJun Zha. Rank diminishing in deep neural networks. Advances in Neural Information\nProcessing Systems , 35:33054\u201333065, 2022.\n[14] Amic Frouvelle and Jian-Guo Liu. Long-time dynamics for a simple aggregation\nequation on the sphere. In International workshop on Stochastic Dynamics out of\nEquilibrium , pages 457\u2013479. Springer, 2017.\n[15] Borjan Geshkovski, Cyril Letrouit, Yury Polyanskiy, and Philippe Rigollet. The\nemergence of clusters in self-attention dynamics. In Thirty-seventh Conference on\nNeural Information Processing Systems , 2023.\n[16] Borjan Geshkovski, Hugo Koubbi, Yury Polyanskiy, and Philippe Rigollet. Dynamic\nmetastability in the self-attention model. arXiv preprint arXiv:2410.06833 , 2024.\n21\n\n--- Page 22 ---\n[17] Borjan Geshkovski, Cyril Letrouit, Yury Polyanskiy, and Philippe Rigollet. A math-\nematical perspective on transformers. Bull. Amer. Math. Soc. , 62:427\u2013479, 2025.\n[18] Seung-Yeal Ha, Dongnam Ko, and Seung-Yeon Ryoo. On the Relaxation Dynamics\nof Lohe Oscillators on Some Riemannian Manifolds. Journal of Statistical Physics ,\n172:1427\u20131478, 06 2018.\n[19] Ali Jadbabaie, Jie Lin, and A Stephen Morse. Coordination of groups of mobile\nautonomous agents using nearest neighbor rules. IEEE Transactions on Automatic\nControl , 48(6):988\u20131001, 2003.\n[20] Vishesh Jain, Clayton Mizgerd, and Mehtaab Sawhney. The random graph process\nis globally synchronizing. arXiv preprint arXiv:2501.12205 , 2025.\n[21] Nikita Karagodin, Yury Polyanskiy, and Philippe Rigollet. Clustering in causal at-\ntention masking. In The Thirty-eighth Annual Conference on Neural Information\nProcessing Systems , 2024.\n[22] Martin Kassabov, Steven H. Strogatz, and Alex Townsend. Sufficiently dense ku-\nramoto networks are globally synchronizing. Chaos: An Interdisciplinary Journal of\nNonlinear Science , 31(7):073135, Jul 2021.\n[23] Hugo Koubbi, Matthieu Boussard, and Louis Hernandez. The impact of LoRA on\nthe emergence of clusters in transformers. arXiv preprint arXiv:2402.15415 , 2024.\n[24] Yoshiki Kuramoto. Self-entrainment of a population of coupled non-linear oscillators.\nInInternational Symposium on Mathematical Problems in Theoretical Physics , pages\n420\u2013422, Berlin, Heidelberg, 1975. Springer Berlin Heidelberg.\n[25] Stanislaw  Lojasiewicz. Une propri\u00b4 et\u00b4 e topologique des sous-ensembles analytiques\nr\u00b4 eels. Les\u00b4Equations aux D\u00b4 eriv\u00b4 ees Partielles , 117:87\u201389, 1963.\n[26] Johan Markdahl, Johan Thunberg, and Jorge Gon\u00b8 calves. Almost global consensus\non the n-sphere. IEEE Transactions on Automatic Control , 63(6):1664\u20131675, 2018.\n[27] Renato E Mirollo and Steven H Strogatz. Synchronization of pulse-coupled biological\noscillators. SIAM Journal on Applied Mathematics , 50(6):1645\u20131662, 1990.\n[28] Javier Morales and David Poyato. On the trend to global equilibrium for kuramoto\noscillators. Annales de l\u2019Institut Henri Poincar\u00b4 e C , 40(3):631\u2013716, 2022.\n[29] Michael E Sander, Pierre Ablin, Mathieu Blondel, and Gabriel Peyr\u00b4 e. Sinkform-\ners: Transformers with doubly stochastic attention. In International Conference on\nArtificial Intelligence and Statistics , pages 3515\u20133530. PMLR, 2022.\n[30] Han Shi, Jiahui Gao, Hang Xu, Xiaodan Liang, Zhenguo Li, Lingpeng Kong, Stephen\nM. S. Lee, and James Kwok. Revisiting over-smoothing in BERT from the perspective\nof graph. In International Conference on Learning Representations , 2022.\n22\n\n--- Page 23 ---\n[31] Michael Shub. Global Stability of Dynamical Systems . Springer New York, NY, 1\nedition, 2013.\n[32] Steven H Strogatz. From Kuramoto to Crawford: exploring the onset of synchro-\nnization in populations of coupled oscillators. Physica D: Nonlinear Phenomena , 143\n(1-4):1\u201320, 2000.\n[33] Richard Taylor. There is no non-zero stable fixed point for dense networks in the\nhomogeneous Kuramoto model. Journal of Physics A: Mathematical and Theoretical ,\n45(5):055102, Jan 2012.\n[34] Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N\nGomez,  Lukasz Kaiser, and Illia Polosukhin. Attention is all you need. In Advances\nin Neural Information Processing Systems , volume 30. Curran Associates, Inc., 2017.\n[35] Tam\u00b4 as Vicsek, Andr\u00b4 as Czir\u00b4 ok, Eshel Ben-Jacob, Inon Cohen, and Ofer Shochet.\nNovel type of phase transition in a system of self-driven particles. Physical Review\nLetters , 75(6):1226, 1995.\n[36] Arthur T Winfree. Biological rhythms and the behavior of populations of coupled\noscillators. Journal of Theoretical Biology , 16(1):15\u201342, 1967.\n[37] Ryosuke Yoneda, Tsuyoshi Tatsukawa, and Jun-nosuke Teramae. The lower bound\nof the network connectivity guaranteeing in-phase synchronization. Chaos: An In-\nterdisciplinary Journal of Nonlinear Science , 31(6):063124, Jun 2021.\nA Results for \u03b2 >1\n3\nIn this subsection, f(x) = sin( x)e\u03b2(cos(x)\u22121).\nLemma A.1. Suppose \u03b2 >1\n3. There exists 0< b < a < \u03c0 such that the positive region\noff\u2032\u2032\u2032(x)is(\u2212a,\u2212b)\u2294(b, a).\nProof. Let\np(z) =\u2212(z+ 3\u03b2z2\u22124\u03b2(1\u2212z2)\u22126\u03b22z(1\u2212z2) +\u03b23(1\u2212z2)2).\nObserve that\nf\u2032\u2032\u2032(x) =p(cos(x))e\u03b2(cos(x)\u22121),\nso it suffices to analyze the positive regions of pover [\u22121,1]. First, observe that\np(1) =\u22121\u22123\u03b2 <0, p(1\u22120.3\n\u03b2) = 1 .688\u22120.1761\u03b2\u22121+ 0.24\u03b2 >0,\np(\u22121) = 1 \u22123\u03b2 <0, p(\u22121\u22122\n\u03b2) = 5 \u03b2+ 6\u03b2\u22121+ 13 >0.\n23\n\n--- Page 24 ---\nSince p(\u22121)<0 and p(\u22121\u22122\n\u03b2)>0,phas two roots less than \u22121. Furthermore, since\np(1)<0,p(1\u22120.3\n\u03b2)>0, and p(\u22121)<0,phas two roots in [ \u22121,1], and pis positive\nbetween these two roots. This finishes the proof. \u25a0\nLemma A.2.\u221axarccos(\u221a\n1+4x2\u22121\n2x)is strictly increasing over (0,\u221e).\nProof. We compute that\nd\ndx\u221axarccos(\u221a\n1 + 4 x2\u22121\n2x) =arccos(\u221a\n1+4x2\u22121\n2x)\u2212\u221a\u221a\n1+4x2\u22121\u221a\n2x2+1\n2\n2\u221ax.\nTherefore, it suffices to prove that\narccos(\u221a\n1 + 4 x2\u22121\n2x)>p\u221a\n1 + 4 x2\u22121q\n2x2+1\n2\u21d4\u221a\n1 + 4 x2\u22121\n2x<cos(p\u221a\n1 + 4 x2\u22121q\n2x2+1\n2).\nObserve that using cos( z)\u22651\u2212z2\n2over (0 , \u03c0) yields\ncos(p\u221a\n1 + 4 x2\u22121q\n2x2+1\n2)\u22651\u2212\u221a\n1 + 4 x2\u22121\n1 + 4 x2.\nThen, it suffices to prove that\n\u221a\n1 + 4 x2\u22121\n2x<1\u2212\u221a\n1 + 4 x2\u22121\n1 + 4 x2\n\u21d4\u221a\n1 + 4 x2(1\n2x+1\n1 + 4 x2)<1 +1\n1 + 4 x2+1\n2x\n\u21d4\u221a\n1 + 4 x2(1 + 2 x+ 4x2)<(1 + 4 x2)2x+ 1 + 2 x+ 4x2\n\u21d4(\u221a\n1 + 4 x2\u22121)(1 + 2 x+ 4x2)<(1 + 4 x2)2x\n\u21d42x(1 + 2 x+ 4x2)<(1 +\u221a\n1 + 4 x2)(1 + 4 x2),\nwhich is straightforward to verify. \u25a0\nThe following corollary also appears in [21, Lemma 4].\nCorollary A.3. arccos(\u221a\n1+4x2\u22121\n2x)<1\u221axover (0,\u221e).\nProof. This follows from Lemma A.2 and lim x\u2192\u221e\u221axarccos(\u221a\n1+4x2\u22121\n2x) = 1. \u25a0\nLemma A.4. If\u03b2\u22651then \u03c4(f\u2032\u2032(a)\u2212f\u2032\u2032(b))<2.\n24\n\n--- Page 25 ---\nProof. Letw= 1\u2212cos(x) and assume that x\u2208[0, \u03c0] so that sin( x)\u22650. Then,\nf\u2032\u2032(x) =\u221a\n2w\u2212w2(\u22121\u22123\u03b2(1\u2212w) +\u03b22(2w\u2212w2))e\u2212\u03b2w\n=\u221a\n2w\u2212w2(\u03b2(\u22123 + 2 \u03b2w) + (\u22121 + 3 \u03b2w\u2212\u03b22w2))e\u2212\u03b2w.\nLetz=\u03b2w. Hence,\nf\u2032\u2032(x) =p\n\u03b2\u221azr\n2\u2212z\n\u03b2(\u22123 + 2 z+1\n\u03b2(\u22121 + 3 z\u2212z2))e\u2212z.\nLet\ng\u03b2(z) =\u221azr\n2\u2212z\n\u03b2(\u22123 + 2 z+1\n\u03b2(\u22121 + 3 z\u2212z2))e\u2212z\nwhere z\u2208[0,2\u03b2]. Note that f\u2032\u2032(x) =\u221a\u03b2g\u03b2(\u03b2\u2212\u03b2cos(x)) so\nf\u2032\u2032\u2032(x) =\u03b2p\n\u03b2sin(x)g\u2032\n\u03b2(\u03b2\u2212\u03b2cos(x))\nSince x\u2208[0, \u03c0] and the positive region of f\u2032\u2032\u2032in [0, \u03c0] is (b, a), the positive region of g\u2032\n\u03b2\nis (\u03b2(1\u2212cos(b)), \u03b2(1\u2212cos(a))). Particularly,f\u2032\u2032(a)\u2212f\u2032\u2032(b)\u221a\u03b2=g\u03b2(\u03b2(1\u2212cos(a)))\u2212g\u03b2(\u03b2(1\u2212\ncos(b))).\nFirst, observe that g\u2032\n\u03b2(0.18)<0 and g\u2032\n\u03b2(1.4)>0 for all \u03b2\u22651. Therefore, because the\npositive region is continuous, we always have that\n0.18< \u03b2(1\u2212cos(b))<1.4< \u03b2(1\u2212cos(a)).\nMoreover, g\u03b2(\u03b2(1\u2212cos(a)))>0> g\u03b2(\u03b2(1\u2212cos(b))); this is because g\u03b2(0) = 0, g\u03b2(0.1)<0,\nandg\u03b2(1.9)>0, so g\u03b2first decreases to a negative value and then increases to a positive\nvalue.\nLet\ng1(z) =\u221a\n2z(\u22123 + 2 z)e\u2212z, g2(z) =\u221a\n2z(\u22121 + 3 z\u2212z2)e\u2212z.\nThen, g\u03b2is similar to a linear combination of g1andg2, with\ng\u03b2(z) =q\n2\u2212z\n\u03b2\u221a\n2(g1(z) +1\n\u03b2g2(z)).\nFor the following computations, we utilize properties of g1andg2which are straightfor-\nward to verify.\nBecause 0 .18< \u03b2(1\u2212cos(b))<1.4, the value ofq\n2\u2212z\n\u03b2g2(z) atz=\u03b2(1\u2212cos(b)) is\nat least r\n2\u22120.18\n\u03b2g2(0.18)>\u22120.247r\n2\u22120.18\n\u03b2.\nFurthermore, the value ofq\n2\u2212z\n\u03b2g1(z) atz=\u03b2(1\u2212cos(b)) is at least\n\u22121.381r\n2\u22120.18\n\u03b2,\n25\n\n--- Page 26 ---\nsince g1>\u22121.381. Therefore, the value of g\u03b2atz=\u03b2(1\u2212cos(b)) is greater than\n\u22120.247q\n2\u22120.18\n\u03b2\u221a\n2\u03b2\u22121.381q\n2\u22120.18\n\u03b2\u221a\n2. (9)\nSince \u03b2(1\u2212cos(a))>1.4, the value ofq\n2\u2212z\n\u03b2g2(z) atz=\u03b2(1\u2212cos(a)) is at most\nr\n2\u22121.4\n\u03b2g2(1.4)<0.512r\n2\u22121.4\n\u03b2.\nFurthermore, the value ofq\n2\u2212z\n\u03b2g1(z) atz=\u03b2(1\u2212cos(a)) is at most\n0.375r\n2\u22121.5\n\u03b2,\nsince g1\u22640 for z\u22641.5 and g1<0.375. Therefore, the value of g\u03b2atz=\u03b2(1\u2212cos(a))\nis less than\n0.512q\n2\u22121.4\n\u03b2\u221a\n2\u03b2+ 0.375q\n2\u22121.5\n\u03b2\u221a\n2.\nUsing this inequality and (9) gives that\ng\u03b2(\u03b2(1\u2212cos(a)))\u2212g\u03b2(\u03b2(1\u2212cos(b)))<\n0.512q\n2\u22121.4\n\u03b2\u221a\n2\u03b2+ 0.375q\n2\u22121.5\n\u03b2\u221a\n2+ 0.247q\n2\u22120.18\n\u03b2\u221a\n2\u03b2+ 1.381q\n2\u22120.18\n\u03b2\u221a\n2.\nLet\n\u03c6(\u03b2) = 0 .512q\n2\u22121.4\n\u03b2\u221a\n2\u03b2+ 0.375q\n2\u22121.5\n\u03b2\u221a\n2+ 0.247q\n2\u22120.18\n\u03b2\u221a\n2\u03b2+ 1.381q\n2\u22120.18\n\u03b2\u221a\n2\nfor\u03b2\u22651, so that g\u03b2(\u03b2(1\u2212cos(a)))\u2212g\u03b2(\u03b2(1\u2212cos(b)))< \u03c6(\u03b2).\nIf\u03b2\u22652 then \u03c6(\u03b2)<2, so\n\u03c4(f\u2032\u2032(a)\u2212f\u2032\u2032(b)) =p\n\u03b2\u03c4(g\u03b2(\u03b2(1\u2212cos(a)))\u2212g\u03b2(\u03b2(1\u2212cos(b))))<p\n\u03b2\u03c4\u03c6(\u03b2)<2p\n\u03b2\u03c4.\nSince\u221a\u03b2\u03c4 < 1 by Corollary A.3, \u03c4(f\u2032\u2032(a)\u2212f\u2032\u2032(b))<2.\nAssume that \u03b2\u2208[1,2). Then, from Lemma A.2,\u221a\u03b2\u03c4 <\u221a\n2\u03c4(2)<0.96, so \u03c4(f\u2032\u2032(a)\u2212\nf\u2032\u2032(b))<0.96\u03c6(\u03b2)<2. \u25a0\nLemma A.5. Suppose \u03b2\u2208[0.75,1). Then, \u03c4(f\u2032\u2032(a)\u2212f\u2032\u2032(b))<2.\n26\n\n--- Page 27 ---\nProof. Observe that g\u2032\n\u03b2(0.165)<0 and g\u2032\n\u03b2(1.24)>0 for \u03b2\u2208[0.75,1). Thus,\n0.165< \u03b2(1\u2212cos(b))<1.24< \u03b2(1\u2212cos(a)).\nSimilarly, g\u03b2(\u03b2(1\u2212cos(a)))>0> g \u03b2(\u03b2(1\u2212cos(b))), because g\u03b2(0) = 0, g\u03b2(0.1)<0,\ng\u03b2(1.4)>0. Therefore,\ng\u03b2(\u03b2(1\u2212cos(a)))\u2212g\u03b2(\u03b2(1\u2212cos(b)))<\n0.54q\n2\u22121.24\n\u03b2\u221a\n2\u03b2+ 0.375q\n2\u22121.5\n\u03b2\u221a\n2+ 0.26q\n2\u22120.165\n\u03b2\u221a\n2\u03b2+ 1.381q\n2\u22120.165\n\u03b2\u221a\n2=:\u03c6(\u03b2)\nover [0 .75,1). Using Lemma A.2,\u221a\u03b2\u03c4 < \u03c4 (1)<0.91, so \u03c4(f\u2032\u2032(a)\u2212f\u2032\u2032(b))<0.91\u03c6(\u03b2)<\n2. \u25a0\nLemma A.6. Suppose \u03b2\u2208[0.5,0.75). Then, \u03c4(f\u2032\u2032(a)\u2212f\u2032\u2032(b))<2.\nProof. Observe that g\u2032\n\u03b2(0.14)<0 and g\u2032\n\u03b2(0.9)>0 for \u03b2\u2208[0.5,0.75). Thus,\n0.14< \u03b2(1\u2212cos(b))<0.9< \u03b2(1\u2212cos(a)).\nSimilarly, g\u03b2(\u03b2(1\u2212cos(a)))>0> g \u03b2(\u03b2(1\u2212cos(b))), because g\u03b2(0) = 0, g\u03b2(0.1)<0,\ng\u03b2(0.99)>0. Therefore,\ng\u03b2(\u03b2(1\u2212cos(a)))\u2212g\u03b2(\u03b2(1\u2212cos(b)))<\n0.542q\n2\u22120.9\n\u03b2\u221a\n2\u03b2+ 0.28q\n2\u22120.14\n\u03b2\u221a\n2\u03b2+ 1.381q\n2\u22120.14\n\u03b2\u221a\n2=:\u03c6(\u03b2)\nover [0 .5,0.75); observe that we have removed the term 0 .375q\n2\u22121.5\n\u03b2\u221a\n2forg1, since g1is al-\nways non-positive when \u03b2\u22640.75 and z\u22642\u03b2. Using Lemma A.2,\u221a\u03b2\u03c4 <\u221a\n0.75\u03c4(\u221a\n0.75)<\n0.88, so \u03c4(f\u2032\u2032(a)\u2212f\u2032\u2032(b))<0.88\u03c6(\u03b2)<2. \u25a0\nLemma A.7. Suppose \u03b2\u2208(1\n3,0.5). Then, \u03c4(f\u2032\u2032(a)\u2212f\u2032\u2032(b))<2.\nProof. Observe that g\u2032\n\u03b2(0.121)<0 and g\u2032\n\u03b2(2\n3)>0 for \u03b2\u2208(1\n3,0.5). Thus,\n0.12< \u03b2(1\u2212cos(b))<2\n3< \u03b2(1\u2212cos(a)).\nSimilarly, g\u03b2(\u03b2(1\u2212cos(a)))>0> g \u03b2(\u03b2(1\u2212cos(b))), because g\u03b2(0) = 0, g\u03b2(0.1)<0,\ng\u03b2(2\n3)>0.\nSince z\u22642\u03b2 < 1, the maximal positive value of g2is less than g2(1)<0.521.\nTherefore,\ng\u03b2(\u03b2(1\u2212cos(a)))\u2212g\u03b2(\u03b2(1\u2212cos(b)))<\n0.521q\n2\u22122/3\n\u03b2\u221a\n2\u03b2+ 0.285q\n2\u22120.121\n\u03b2\u221a\n2\u03b2+ 1.381q\n2\u22120.121\n\u03b2\u221a\n2=:\u03c6(\u03b2)\nover (1\n3,0.5); similarly, we have removed the positive term for g1. Using Lemma A.2,\u221a\u03b2\u03c4 <\u221a\n0.5\u03c4(0.5)<0.809, so \u03c4(f\u2032\u2032(a)\u2212f\u2032\u2032(b))<0.809\u03c6(\u03b2)<2. \u25a0\n27\n\n--- Page 28 ---\nB Results for 0< \u03b2\u22641\n3\nIn this subsection, f(x) = sin( x)e\u03b2(cos(x)\u22121).\nLemma B.1. Suppose \u03b2\u2208(0,1\n3]. Then, there exists a\u2208(0,\u03c0\n2)such that the nonnegative\nregion of f\u2032\u2032\u2032(x)over [0,2\u03c0)is[a,2\u03c0\u2212a].\nProof. We use the same method as the proof of Lemma A.1. Observe that\np(1) =\u22121\u22123\u03b2 <0, p(0) =\u2212\u03b2(\u03b22\u22124)>0, p(\u22121) = 1 \u22123\u03b2\u22650,\np(\u22121\u22121\n\u03b2) = 5 \u03b2\u2212\u03b2\u22121+ 1<0, p(\u22121\u22122\n\u03b2) = 5 \u03b2+ 6\u03b2\u22121+ 13 >0,\nand lim z\u2192\u2212\u221e p(z) =\u2212\u221e. Thus, phas a root in each of the following intervals: (0 ,1),\n(\u22121\u22121\n\u03b2,\u22121], (\u22121\u22122\n\u03b2,\u22121\u22121\n\u03b2), and ( \u2212\u221e,\u22121\u22122\n\u03b2).\nLetrbe the root of pin (0,1). Let a= arccos( r). Because r\u2208(0,1),a\u2208(0,\u03c0\n2).\nFurthermore, because p(1)<0,p(0)>0, and phas no other roots in ( \u22121,1),p(z) is\nnonnegative for z\u2208[\u22121,1] if and only if z\u2208[\u22121, r]. Therefore, the nonnegative region\noff\u2032\u2032\u2032is [a,2\u03c0\u2212a]. \u25a0\nRemark B.2.In contrast with Lemma A.1, we consider the nonnegative region of f\u2032\u2032\u2032\nrather than the positive region. The reason for this is that when \u03b2=1\n3,p(\u22121) = 0, so\nthe positive region would be ( a, \u03c0)\u222a(\u03c0,2\u03c0\u2212a) for this case. For simplicity, we consider\nthe nonnegative region.\nCorollary B.3. Suppose \u03b2\u2208(0,1\n3]. Then, f\u2032\u2032\u22640over [0, \u03c0]andf\u2032\u2032\u22650over [\u03c0,2\u03c0].\nProof. Using Lemma B.1, assume that the nonnegative region of f\u2032\u2032\u2032is [a,2\u03c0\u2212a] for\na\u2208(0,\u03c0\n2). Then, since f\u2032\u2032(0) = f\u2032\u2032(\u03c0) = 0, we have that over [0 , \u03c0],f\u2032\u2032first decreases\nfrom 0 to its minimal value at aand then increases to 0, so f\u2032\u2032is non-positive. Because\nf\u2032\u2032is odd, f\u2032\u2032is nonnegative over [ \u03c0,2\u03c0]. \u25a0\nLemma B.4. Suppose \u03b2\u2208(0,1\n3]. Then, \u03c4f\u2032\u2032(a)>\u22122.\nProof. We have that\nf\u2032\u2032(a)\u2265 \u2212(1 + 3 \u03b2) sin(a)e\u03b2cos(a)e\u2212\u03b2\u2265 \u2212(1 + 3 \u03b2) sin(\u03c4)e\u03b2cos(\u03c4)e\u2212\u03b2.\nThus, it suffices to prove that\n(1 + 3 \u03b2) sin(\u03c4)e\u03b2cos(\u03c4)e\u2212\u03b2\u03c4 <2.\nObserve that\n0\u2264cos(\u03c4) =\u03b2sin(\u03c4)2\u2264\u03b2,\nso it suffices to prove that\n(1 + 3 \u03b2)e\u03b22\u2212\u03b2sin(\u03c4)\u03c4 <2.\n28\n\n--- Page 29 ---\nAssume that 0 < \u03b2\u22640.148. Then, \u03c4\u2264\u03c0\n2and sin( \u03c4)\u22641. Because\n(1 + 3 \u03b2)e\u03b22\u2212\u03b2\u00b7\u03c0\n2<2,\nwe have that \u03c4f\u2032\u2032(a)>\u22122. (0.148 is approximately the maximal value of \u03b2for which this\nmethod is correct.)\nAssume that 0 .148< \u03b2\u22640.228. Then, \u03c4 < \u03c4 (0.148) <1.43 and sin( \u03c4)<sin(1.43).\nBecause\n(1 + 3 \u03b2)e\u03b22\u2212\u03b2\u00b71.43 sin(1 .43)<2,\nwe have that \u03c4f\u2032\u2032(a)>\u22122.\nAssume that 0 .228< \u03b2\u22640.278. Then, \u03c4 < \u03c4 (0.228) <1.36 and sin( \u03c4)<sin(1.36).\nBecause\n(1 + 3 \u03b2)e\u03b22\u2212\u03b2\u00b71.36 sin(1 .36)<2,\nwe have that \u03c4f\u2032\u2032(a)>\u22122.\nAssume that 0 .278< \u03b2\u22640.321. Then, \u03c4 < \u03c4 (0.278) <1.31 and sin( \u03c4)<sin(1.31).\nBecause\n(1 + 3 \u03b2)e\u03b22\u2212\u03b2\u00b71.31 sin(1 .31)<2,\nwe have that \u03c4f\u2032\u2032(a)>\u22122.\nAssume that 0 .321< \u03b2\u22641\n3. Then, \u03c4 < \u03c4 (0.321) <1.28 and sin( \u03c4)<sin(1.28).\nBecause\n(1 + 3 \u03b2)e\u03b22\u2212\u03b2\u00b71.28 sin(1 .28)<2,\nwe have that \u03c4f\u2032\u2032(a)>\u22122. \u25a0\nC Results for \u22121\n3< \u03b2 < 0\nIn this subsection, f(x) = sin( x)e\u03b2(cos(x)\u22121).\nLemma C.1. Suppose \u03b2\u2208(\u22121\n3,0). Then, there exists a\u2208(\u03c0\n2, \u03c0)such that the nonnega-\ntive region of f\u2032\u2032\u2032(x)over [0,2\u03c0)is[a,2\u03c0\u2212a].\nProof. We use the same method as the proof of Lemma A.1. Observe that\np(1) =\u22121\u22123\u03b2 <0, p(0) =\u2212\u03b2(\u03b22\u22124)<0, p(\u22121) = 1 \u22123\u03b2 >0,\np(1\u22121\n\u03b2) = 5 \u03b2\u2212\u03b2\u22121\u22121>0, p(1\u22122\n\u03b2) = 5 \u03b2+ 6\u03b2\u22121\u221213<0,\nand lim z\u2192\u221ep(z) =\u221e. Thus, phas a root in each of the following intervals: ( \u22121,0),\n(1,1\u22121\n\u03b2), (1\u22121\n\u03b2,1\u22122\n\u03b2), and (1 \u22122\n\u03b2,\u221e).\nLetrbe the root of pin (\u22121,0). Let a= arccos( r). Because r\u2208(\u22121,0),a\u2208(\u03c0\n2, \u03c0).\nFurthermore, because p(\u22121)>0,p(0)<0, and phas no other roots in ( \u22121,1),p(z) is\nnonnegative for z\u2208[\u22121,1] if and only if z\u2208[\u22121, r]. Therefore, the nonnegative region\noff\u2032\u2032\u2032is [a,2\u03c0\u2212a]. \u25a0\n29\n\n--- Page 30 ---\nRemark C.2.If\u03b2=\u22121\n3, the nonnegative region of f\u2032\u2032\u2032(x) over [0 ,2\u03c0) is [a,2\u03c0\u2212a]\u222a {0},\nsince p(1) = 0.\nCorollary C.3. Suppose \u03b2\u2208(\u22121\n3,0). Then, f\u2032\u2032\u22640over [0, \u03c0]andf\u2032\u2032\u22650over [\u03c0,2\u03c0].\nProof. Using Lemma B.1, assume that the nonnegative region of f\u2032\u2032\u2032is [a,2\u03c0\u2212a] for\na\u2208(\u03c0\n2, \u03c0). Then, since f\u2032\u2032(0) = f\u2032\u2032(\u03c0) = 0, we have that over [0 , \u03c0],f\u2032\u2032first decreases\nfrom to 0 to its minimal value at aand then increases to 0, so f\u2032\u2032is non-positive. Because\nf\u2032\u2032is odd, f\u2032\u2032is nonnegative over [ \u03c0,2\u03c0]. \u25a0\nLemma C.4. Suppose \u03b2 <0. Ifxis a stable, stationary, and non-synchronized point of\n(S1), then \u03c4max(x)< \u03c0.\nProof. This is implied by [11, Lemma 10] with \u03c6(t) =\u2212e\u03b2t. \u25a0\nLemma C.5. Suppose \u03b2\u2208[\u22120.16,0). Then, \u03c4f\u2032\u2032(a)\u2265 \u22122\u0000\n1 +\u03c4\n\u03c0\u0001\n.\nProof. We have that\nf\u2032\u2032(a)\u2265 \u2212(1\u22123\u03b2) sin(a)e\u03b2cos(a)e\u2212\u03b2\u2265 \u2212(1\u22123\u03b2) sin(\u03c4)e\u03b2cos(\u03c4)e\u2212\u03b2.\nThus, it suffices to prove that\n(1\u22123\u03b2) sin(\u03c4)e\u03b2cos(\u03c4)e\u2212\u03b2\u03c4\u22642\u0010\n1 +\u03c4\n\u03c0\u0011\n.\nObserve that\n0\u2265cos(\u03c4) =\u03b2sin(\u03c4)2\u2265\u03b2,\nso it suffices to prove that\n(1\u22123\u03b2)e\u03b22\u2212\u03b2sin(\u03c4)\u03c4\u22642\u0010\n1 +\u03c4\n\u03c0\u0011\n.\nEquivalently, it suffices to prove that\n\u03c4\u0012\n(1\u22123\u03b2)e\u03b22\u2212\u03b2sin(\u03c4)\u22122\n\u03c0\u0013\n\u22642.\nAssume that \u03b2\u2208[\u22120.16,0). Observe that both \u03c4and (1 \u22123\u03b2)e\u03b22\u2212\u03b2\u22122\n\u03c0increase as \u03b2\ndecreases from 0. At \u03b2=\u22120.16, we have that\n\u03c4\u0012\n(1\u22123\u03b2)e\u03b22\u2212\u03b2\u22122\n\u03c0\u0013\n\u22642,\nso this must be the case for all \u03b2\u2208[\u22120.16,0). Thus,\n\u03c4\u0012\n(1\u22123\u03b2)e\u03b22\u2212\u03b2sin(\u03c4)\u22122\n\u03c0\u0013\n\u2264\u03c4\u0012\n(1\u22123\u03b2)e\u03b22\u2212\u03b2\u22122\n\u03c0\u0013\n\u22642\nfor all \u03b2\u2208[\u22120.16,0). \u25a0\n30\n\n--- Page 31 ---\nThe lower bound \u22120.16 for \u03b2in Lemma C.5 can be improved, but we omit this\nrefinement for simplicity. We establish that global synchronization does not occur for all\nnegative values of \u03b2.\nLemma C.6. Suppose \u03b2 <\u22122\n3. Then, if nis a multiple of 3or sufficiently large, there\nexists a value of x\u2208Tnsuch that:\n1. There exists three elements p1,p2, and p3ofTsuch that \u230an\n3\u230b,\u230an\n3\u230b, and n\u22122\u230an\n3\u230b\npoints of xare placed at p1,p2, and p3, respectively.\n2. The vector xis a critical point of Eand the Hessian of EoverTnatxis negative\nsemidefinite, with only one eigenvalue whose eigenvectors are the scalar multiples of\nthe vector [1, . . . , 1]\u22a4.\nProof. Suppose n\u22653. Let p1= 0, p2=\u03b1, and p3= 2\u03c0\u2212\u03b1, where \u03b1is an element of\n(0, \u03c0) such that\njn\n3k\nsin(2\u03b1)e\u03b2cos(2 \u03b1)+\u0010\nn\u22122jn\n3k\u0011\nsin(\u03b1)e\u03b2cos(\u03b1)= 0;\nasn\u2192 \u221e , we can set \u03b1=2\u03c0\n3+on(1) and in particular we can set \u03b1=2\u03c0\n3when nis a\nmultiple of 3.\nThe Hessian of the energy function Eis the Laplacian Lof [\u2212f\u2032(xi\u2212xj)]n\ni,j=1. Recall\nthatf\u2032(x) = (cos( x)\u2212\u03b2sin(x)2)e\u03b2(cos(x)\u22121)and the Laplacian of a symmetric n\u00d7nmatrix\nAisD\u2212A, where Dis the diagonal matrix with diagonal [Pn\ni=1Aij]1\u2264j\u2264n. Furthermore,\nfor a vector v,\nv\u22a4Lv=\u2212nX\ni,j=11\n2f\u2032(xi\u2212xj)(vi\u2212vj)2.\nHowever, we always have that |xi\u2212xj| \u2208 {0, \u03b1,2\u03c0\u2212\u03b1}. Since \u03b2 <\u22122\n3and\u03b1=2\u03c0\n3+on(1),\nf\u2032(x)>0 for all x\u2208 {0, \u03b1,2\u03c0\u2212\u03b1}when nis sufficiently large; if nis a multiple of 3, we\ncan set \u03b1=2\u03c0\n3to obtain that f\u2032(x)>0 for all x\u2208 {0, \u03b1,2\u03c0\u2212\u03b1}. Thus, condition 2 is\nsatisfied when nis a multiple of 3 or sufficiently large. \u25a0\n31",
  "project_dir": "artifacts/projects/enhanced_cs.LG_2507.22857v1_Synchronization_of_mean_field_models_on_the_circle",
  "communication_dir": "artifacts/projects/enhanced_cs.LG_2507.22857v1_Synchronization_of_mean_field_models_on_the_circle/.agent_comm",
  "assigned_at": "2025-07-31T21:43:47.738825",
  "status": "assigned"
}